package com.cer.test;

import java.util.List;

import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.transaction.TransactionConfiguration;
import org.springframework.transaction.annotation.Transactional;

import com.cer.dao.GMDao;
import com.cer.persistent.DriverInformation;
import com.cer.persistent.RouteTrackSystem;
import com.cer.persistent.TruckInformation;
import com.cer.services.RouteTrackingService;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath:GreatMart.xml" })
@TransactionConfiguration(transactionManager = "gmTransactionManager", defaultRollback = false)
@Transactional
public class RouteInformationTest {
	protected final Logger logger = LoggerFactory.getLogger(RouteInformationTest.class);
	
	@Autowired
	private RouteTrackingService routeTrackingService;
	
	@Autowired
	private GMDao gmDao;
	
	@Test
	public void testRouteSave()
	{
		logger.info("testRouteSave start ");
		RouteTrackSystem routeTrackSystem = new RouteTrackSystem();
		List<DriverInformation> l1 = gmDao.find("from DriverInformation where driverId = ? ", 1L);
		if(l1 != null && l1.size() > 0)
		{
			routeTrackSystem.setDriverid((DriverInformation)l1.get(0));
		}
		List<TruckInformation> l2 = gmDao.find("from TruckInformation where id = ? ", 1L);
		if(l2 != null && l2.size() > 0)
		{
			routeTrackSystem.setTruckId((TruckInformation)l2.get(0));
		}
		
		
		routeTrackSystem.setRefuelCost(23.0);
		routeTrackSystem.setReFuelType("Petrol");
		routeTrackSystem.setTollTax(11.30);
		//routeTrackSystem.setRouteGeojson("{\"type\": \"Polygon\",\"coordinates\": [[[77.2503662109375,28.618281599983852],[78.760986328125,28.810986808864513],[79.530029296875,29.214507763499352],[78.1402587890625,29.912090918781505],[77.7008056640625,28.98411731593083],[75.7012939453125,29.14736383122664],[76.6680908203125,28.86872905602898],[77.2503662109375,28.618281599983852]]]}");
		routeTrackSystem.setRouteGeojson("{\"type\": \"Polygon\",\"coordinates\": [[[77.6953125,29.47307903155816],[77.706298828125,29.47307903155816],[77.7117919921875,29.462318337210935],[77.70904541015625,29.45753543987987],[77.7227783203125,29.45155650109173],[77.73170471191406,29.446474126109276],[77.73582458496094,29.44378335395693],[77.7392578125,29.441391496603618],[77.74337768554688,29.438401595657528],[77.74681091308594,29.435112602913108],[77.75333404541016,29.427936248946832],[77.7567672729492,29.423749808286058],[77.7615737915039,29.42016129325236],[77.76569366455078,29.41537640937432],[77.77667999267578,29.40460959688575],[77.78182983398438,29.399823980826337],[77.7883529663086,29.393243390977627],[77.77839660644531,29.388457240014766],[77.77633666992188,29.384269173200224],[77.77427673339844,29.377986749749617],[77.77050018310547,29.375294163830393],[77.77015686035156,29.37140474730792],[77.76569366455078,29.37140474730792],[77.75951385498047,29.37140474730792],[77.75470733642578,29.37140474730792],[77.75264739990234,29.368711987278648],[77.750244140625,29.3696095818686],[77.74681091308594,29.36841278732347],[77.73857116699219,29.36571994816129],[77.72449493408203,29.36003483162285],[77.72106170654297,29.35764100339896],[77.71865844726562,29.354648639004846],[77.71522521972656,29.354947879399834],[77.71041870117188,29.35674330331052],[77.71419525146484,29.34806512793933],[77.72003173828125,29.333101020913805],[77.72689819335938,29.310351371763023],[77.73239135742188,29.286398892934763],[77.73651123046875,29.275618444611126],[77.72552490234374,29.24446853982615],[77.71865844726562,29.197725900405846],[77.71316528320312,29.153360611334996],[77.71041870117188,29.106576445680282],[77.70904541015625,29.08377645036857],[77.70767211914062,29.05136777451729],[77.706298828125,29.02495317372263],[77.70492553710938,28.99612953724707],[77.6953125,28.9829160170561],[77.66098022460938,28.987721128840377],[77.63214111328124,29.000934035030202],[77.59780883789062,29.018948912608682],[77.56484985351562,29.03095708572103],[77.51266479492188,29.0525682775337],[77.48245239257812,29.069373852431642],[77.46597290039062,29.082576310768772],[77.46047973632811,29.1113758012654],[77.45086669921875,29.120973840852503],[77.42340087890625,29.113775395114416],[77.398681640625,29.10057693644057],[77.35885620117186,29.10297678210169],[77.31491088867188,29.099376992628493],[77.27096557617188,29.105376571809618],[77.25723266601562,29.10897615145302],[77.26959228515625,29.134169682901746],[77.26821899414062,29.14496502116881],[77.2723388671875,29.16895060109228],[77.28195190429688,29.184538223460272],[77.28469848632812,29.194129429421352],[77.28057861328125,29.221699149280646],[77.2833251953125,29.252855985973763],[77.28469848632812,29.267232865200878],[77.28881835937499,29.287596650313482],[77.27920532226562,29.316338613413944],[77.27920532226562,29.3295093083647],[77.28057861328125,29.355845595310743],[77.28744506835938,29.376191700384762],[77.2943115234375,29.39773020297217],[77.29293823242188,29.413282951826233],[77.29568481445312,29.42763722319321],[77.30392456054688,29.44677309638942],[77.31765747070312,29.45753543987987],[77.35061645507812,29.463514026304715],[77.38632202148438,29.47307903155816],[77.40966796875,29.471883455244765],[77.43576049804688,29.470687864832556],[77.45773315429688,29.470687864832556],[77.50579833984375,29.47427459377244],[77.53326416015625,29.477861195816843],[77.5689697265625,29.476665675902137],[77.62390136718749,29.463514026304715],[77.65548706054686,29.459926916735892],[77.684326171875,29.462318337210935],[77.6953125,29.47307903155816]]]}");
		Assert.assertNotNull("Unable to Save", routeTrackingService.saveRoute(routeTrackSystem) );
		
		logger.info("testRouteSave false ");
	}
	
}
